## S3 버킷 버저닝 설정하기 
S3은 자체적으로 파일 버전 관리(Version Control) 기능을 내장하고 있다.  
이 버저닝(Versioning) 기능을 활용하면 파일을 이전 내용으로 되돌릴 수 있고, 삭제한 파일도  
복원할 수 있다. 단 그만큼 파일 저장 용량이 늘어나므로 사용 요금이 늘어난다. 따라서 용량이 작은 파일이  
대부분일 때 사용하는 것을 추천한다.   
  
버킷의 속성 탭에서 버킷 버전 관리 부분에 편집 버튼을 누르면 버저닝 기능을 사용할   
수 있다.  
<img src="https://user-images.githubusercontent.com/33191974/155330294-0a428b21-586a-4fd7-84bf-fb1f2c3ff6a5.png" width="50%" height="50%"/>    
버저닝 기능을 사용하면 아래와 같이 파일의 버전을 볼 수 있다.   
<img src="https://user-images.githubusercontent.com/33191974/155332096-f18952f5-f26b-4d19-a13d-b873c9fdda96.png" width="50%" height="50%"/>   
예를 들어 file.png에 대해서 (상태1) -> (상태2) -> (상태3)이 다 기록이 남는다.   
즉, 덮어쓰기가 아니다.  만약 file.png가 삭제된다면 `(상태1) -> (상태2) ->   
(상태3)[삭제됨]`이 남는다.    
버저닝은 중간에 끌 수 있다. 하지만 껏을 때의 버저닝 기능만 중단될 뿐, 이미   
버저닝된 파일은 그대로 남고 볼 수 있다.   
버저닝된 오래된 파일을 모두 지우고 싶으면 bucket을 새로만들고, sync나 수동복사를   
통해 복사한 다음, 새로운 bucket을 사용하자.  

# Q. 버전 관리 비용은 어떻게 부과될까?  
저장되거나 요청된 객체의 모든 버전에는 일반 Amazon S3 요금이 적용된다.   
예를 들어, 버전 관리를 사용할 경우, 스토리지 비용을 산정하는 다음 시나리오를  
살펴보자(현재 월의 일수가 31일이라고 가정)   
1. 해당 월의 1일: 버킷에서 4GB의 PUT을 수행한다. a.zip = 4GB
2. 해당 월의 16일: 동일한 버킷 내에서 1일의 원본 PUT와 동일한 키를 사용해   
5GB의 PUT을 수행한다. a.zip = 5GB (덮어쓰기)  
위 작업의 스토리지 비용을 분석할 경우 15일에 5GB 객체를 기록할 때 1일의 4GB  
객체가 버킷에서 삭제되지 않는다는 점에 유의하자. 그 대신, 4GB 객체가 기존  
버전으로 보존되고 5GB 객체가 버킷 내에서 가장 최근에 기록된 버전의 객체가 된다.  
<img src="https://user-images.githubusercontent.com/33191974/155333744-540f48e9-19f6-46c1-a773-2966b1955389.png" width="50%" height="50%"/>   

# 현재 사용중인 용량 확인  
S3 > Management > Metrics 에서 확인할 수 있다.   
현재 114GB를 사용중이다. 즉 한달에 114GB * 0.025 = 2.85달러 (약 3000원)  

# 결론
별도의 백업을 하지 않는다면 버저닝(버전관리) 기능을 사용하는 것을 권장한다.   







