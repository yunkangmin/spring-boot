# 정리
실행 컨텍스트 스택에 쌓인 스코프 순서대로 탐색하는 스코프체인

# 스코프 체인(scope chain)이란?
스코프 체인(Scope Chain)은 일종의 리스트로서 전역 객체와 중첩된 함수의 스코프의  
레퍼런스를 차례로 저장하고, 의미 그대로 각각의 스코프가 연결(chain)되고 있는지  
보여주는 것을 말한다.  
  
하지만 스코프 체인을 이해하기 위해서 먼저 자바스크립트의 실행 컨텍스트를 알아야  
한다.  

# 그렇다면 실행 컨텍스트란 무엇인가?
실행 컨텍스트(Execution context)는 우리가 작성한 코드가 실행되는 환경을 말하며  
scope, hoisting, this, function, closure 등의 동작원리를 담고 있는 자바스크립트의  
핵심원리를 말한다.  
  
그리고 이 실행 컨텍스트에는 두 개의 실행 컨텍스트가 존재한다.  

## 글로벌 실행 컨텍스트(Gloal Execution Context)란?  
코드가 실행되기 전에 생성이 되며, 함수 내에 없는 코드는 모두 전역 실행 컨텍스트    
안에 존재한다.   
그렇기 때문에, 자바스크립트 엔진은 일부 자바스크립트 코드를 실행할 때마다    
글로벌 실행 컨텍스트(Global Execution Context)를 작성한다.    
글로벌 실행 컨텍스트의 특징으로는 무조건 하나의 전역 실행 컨텍스트만이 존재하며    
애플리케이션이 종료될 때(웹 페이지에서 나가거나 브라우저를 닫을 때)까지 유지하는    
것이다.    

## 함수 실행 컨텍스트(Functional Execution Context)란?
전역 실행 컨텍스트가 생성된 후, 함수가 실행(ex) 호출)될 때마다 새로운 실행 컨텍스트가  
작성된다.  

# 실행 컨텍스트에서 스코프 체인은 어떻게 작동하는가?  
실행 컨텍스트는 LIFO(Last in, First out) 구조의 스택으로, 코드 실행 중에 생성된  
모든 실행 컨텍스트를 저장하는 데 사용된다.  
  
실행 컨텍스트가 실행되면, 엔진이 스코프 체인을 통해 렉시컬 스코프를 먼저 파악한다.  
  
그러고 나서 함수가 중첩 상태일 때 하위 함수 내에서 상위 함수의 스코프와 전역 스코프까지   
참조할 수 있는데 이 것을 스코프 체인을 통해 탐색하는 것이다.  
```
var v = "전역 변수";

//function a Execution Context(EC)
function a() {
  var v = "지역 변수";
  
  function b() {
    //function b Execution Context
    console.log(v);
  }
  b();
}

//Global Execution Context
a();
```
위 코드를 보면 먼저 글로벌 실행 컨텍스트(GEC)가 실행되고 스택에 쌓인다. 
  
그런 다음 함수 호출 순으로 실행 컨텍스트 스택에 쌓이게 되고, 가장 나중에 호출된  
b() 함수가 실행 컨텍스트 안에서부터 탐색을 시작한다.  
![image](https://user-images.githubusercontent.com/33191974/150977518-8196ef83-a199-4251-addd-42891df19c6b.png)  
그러면 b() 함수 안에서 변수 v를 탐색하기 시작하는데, 만약 변수가 v가 없으면  
b() 함수를 감싸고 있는 외부 함수 a() 함수를 탐색하기 시작한다.  
  
이 때 a() 함수안에 변수 v가 존재하면 안에 있는 v를 참조하게 되고, 만약 없다면  
마지막으로 전역 객체를 탐색하여 v를 탐색한다.  
  
결국 찾지 못한다면 v가 없다고 Uncaught ReferenceError: v is not defined라는 에러를  
보게 될 것이다.  
  
반대로 찾았다면 결과값은 a() 안에 변수 v가 존재하기 때문에 지역 변수라는 값이  
출력된다.  
  
하지만 만약, a() 함수안에 변수 v를 제거한다면 전역 객체에 있는 변수 v의 값 전역  
변수가 출력이 될 것이다.  
  
이러한 과정들이 스코프에 담긴 순서대로 탐색하는 즉, 스코프 체인이라고 보면 된다.



  




































