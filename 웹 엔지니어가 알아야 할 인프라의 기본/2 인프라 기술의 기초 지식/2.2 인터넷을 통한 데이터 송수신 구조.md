계속해서 인터넷상의 데이터 흐름과 그에 따른 네트워크 기기의 역할 등에 대하여 살펴본다.  
  
### 라우팅
인터넷이 데이터를 운반하는 원리는 아래와 같다.  
우선 라우터가 상위(Default Gateway) 네트워크 와 하위 네트워크를 분리하고 있다.  
라우터가 기점이 되어 그 하위의 네트워크로 보낼 데이터는 하위로, 다른 네트워크로  
보낼 데이터는 상위로 흘려 보냄으로써 네트워크 전체에서 데이터를 주고받는 것이 가능하도록  
되어 있다.  
이 것을 라우팅<sup>Routing</sup>이라고 하며, 단지 이것만을 위해서라면 1U(높이 44.45mm)  
정도의 작은 네트워크 기기로도 대응이 가능하다.  
  
라우터가 네트워크의 상위와 하위의 데이터를 분리하고 있다.  
![image](https://user-images.githubusercontent.com/33191974/128634206-560c4816-0cd6-46b6-ac52-d07511a09439.png)  
  
라우터  
![image](https://user-images.githubusercontent.com/33191974/128634246-e3567f26-741c-49ee-a7b9-bce9b7d5c549.png)  
어느 정도 상위까지 올라가면서 물리적, 논리적으로 직통하는 루트를 만들어 데이터를 주고받게 되는데  
이 부분이 사업자 간의 통신이 된다.  
  
그리고 BGP<sup>Border Gateway Protocol</sup>나 AS<sup>Autonomous System</sup>와 같은 용어가 등장하는 규모에서  
이 정도 상위까지 올라가면 랙에 네트워크 장비가 빽빽하게 들어찬 거대한 네트워크 기기가 사용된다.  
  
### NAT에 의한 IP 주소 변환
글로벌 IP 주소는 그 수가 부족해지고 있기 때문에 이에 대한 대응으로 사설 IP 주소를 활용하는 NAT<sup>Network Address  
Transiation</sup>가 이용되고 있다.  
사설 IP 주소와 글로벌 IP 주소를 변환함으로써, 각각의 기기가 글로벌 IP를 가지지 않은 채로 글로벌 네트워크와 통신을  
할 수 있게 해주는 기술이 NAT이다.  
엄밀하게 말해서 NAT라고 하기보다는 IP 주소와 접속포트를 변환하는 NAPT<sup>Network Address Port Transiation</sup>  
가 사용되는 경우가 많다.  
실제로는 NAT 라우터가 소스 IP와 소스 포트 및 목적지 IP와 목적지 포트를 기억해 둠으로써 IP 주소를 변환하는 구조이다.  
이는 가정용 라우터에서도 흔히 사용되고 있으며, 대규모 서비스에서도 많이 사용되고 있다.  
  
다음 그림과 같이 라우터를 통과하는 타이밍에 소스(PC \-> 서버) IP 주소(SRC), 목적지(서버 \-> PC) IP 주소(DST)로 IP   
주소가 변환된다.  
  
인터넷(IP 네트워크)은 1장에서 언급했던 대로 계층화되어 있다.  
[그러한 계층(레이어) 구조 덕분에 물리적으로 어떻게 접속되어 있더라도 문제없이 데이터를 주고 받을 수 있는 호환성을  
가진다.](https://shlee0882.tistory.com/110)
즉, 눈 앞의 PC에서부터 무선 랜 - ADSL 모뎀 - 전화선 - 유선 랜 - 광 케이블 - 해저 케이블 - ... 등을 무수히 경유하더라도  
문제가 없는 이유는 이러한 계층 구조 덕분이다.  
  
NAT 라우터가 IP 주소를 변환  
![image](https://user-images.githubusercontent.com/33191974/128634907-a760eae8-7e7d-4981-b00c-df49308c1754.png)















